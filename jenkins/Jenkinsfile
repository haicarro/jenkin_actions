pipeline {
    agent any

    stages {
        stage('Build Image') {
            steps {
                echo 'Building Image....'
                withPythonEnv('/home/ec2-user/venv/venv38/') {
                    sh "python --version"
                    withAWS(credentials:'jenkins-aws-credentials-productions', region: 'ap-southeast-1') {
                        sh "sh container/build_and_push.sh"
                    }
                }
            }
        }

    }
}